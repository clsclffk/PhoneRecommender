{% extends "base.html" %}
{% load static %}

{% block title %}ë‹¤ë¥¸ ì·¨ë¯¸ ì‚´í´ë³´ê¸°{% endblock %}

{% block content %}
<div class="container">
  <div class="center-container">

    <!-- í˜ì´ì§€ ì œëª© -->
    <h1 class="page-title">ë‹¤ë¥¸ ì·¨ë¯¸ ì‚´í´ë³´ê¸°</h1>

    <!-- ì£¼ìš” ì½˜í…ì¸  ë°•ìŠ¤ -->
    <div class="content-box">

      <!-- ì„¤ëª… ë°•ìŠ¤ -->
      <div class="description-box">
        <p class="section-title">ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì´ ì„ íƒí•œ ì·¨ë¯¸ ì‚´í´ë³´ê¸°</p>
        <p class="description">
          ì·¨ë¯¸ë¥¼ ì„ íƒí•˜ê¸° ì–´ë ¤ìš´ ì´ìš©ìë‹˜ì„ ìœ„í•´, PHOBBYë¥¼ ì´ìš©í•œ ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì´ ê°€ì¥ ë§ì´ ì„ íƒí•œ ì·¨ë¯¸ë¥¼ ì•Œë ¤ë“œë¦´ê²Œìš”!
        </p>
      </div>

      <!-- ì°¨íŠ¸ -->
      <div class="hobby-rank-section">
        <div class="chart-box">
          <iframe
            src="/django_plotly_dash/app/HobbyGraph/?gender=F&age_group=20s"
            width="100%"
            height="350px"
            scrolling="no"
            frameborder="0"
            style="border: none; width: 100%;"
            sandbox="allow-scripts allow-same-origin allow-popups allow-downloads">
          </iframe>
        </div>
      </div>

    </div> <!-- content-box ë -->

    <!-- ì¶”ì²œ ì·¨ë¯¸ ì„ íƒ ì˜ì—­ (content-boxë¡œ ë³€ê²½) -->
    <div class="content-box">
      <div class="recommend-hobby-choice">
        <!-- í…ìŠ¤íŠ¸ ì™¼ìª½ ì •ë ¬ -->
        <div class="recommend-text">
          <p class="section-title">ğŸ’¡ ë‚˜ì™€ ë¹„ìŠ·í•œ ì´ìš©ìê°€ ê°€ì¥ ë§ì´ ì„ íƒí•œ ì·¨ë¯¸ëŠ”?</p>
          <p>
            ì´ìš©ìë‹˜ì´ ì…ë ¥í•´ì£¼ì‹  ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì´ìš©ìë‹˜ê³¼ ë¹„ìŠ·í•œ ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì´ ê°€ì¥ ë§ì´ ì…ë ¥í•œ ì·¨ë¯¸ë¥¼ ì¶”ì²œí•´ë“œë¦´ê²Œìš”!<br>
            ë” ì•Œì•„ë³´ê³  ì‹¶ì€ ì·¨ë¯¸ê°€ ìˆë‹¤ë©´ ì•„ë˜ ì·¨ë¯¸ ì˜ì—­ ë²„íŠ¼ì„ ëˆ„ë¥´ê³ , 'í‚¤ì›Œë“œ í™•ì¸í•˜ê¸°' ë²„íŠ¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.
          </p>
        </div>

        <!-- ë²„íŠ¼ ì¤‘ì•™ ì •ë ¬ -->
        <form method="post" action="{% url 'recommend-hobby' %}">
          {% csrf_token %}
          <input type="hidden" name="action_type" value="next">
          <input type="hidden" id="selected_hobby" name="selected_hobby" value="">

          <div class="button-group">
            {% for hobby in recommended_hobbies %}
              <button type="button" class="btn recommend-btn" onclick="selectHobby(this, '{{ hobby }}')">{{ hobby }}</button>
            {% endfor %}
          </div>
          <div class="submit-button">
            <button type="submit" class="btn keyword-btn">í‚¤ì›Œë“œ í™•ì¸í•˜ê¸°</button>
          </div>
        </form>
      </div>
    </div> 

    <!-- ì¶”ê°€ ì½˜í…ì¸  ë°•ìŠ¤ (ë‚˜ë§Œì˜ ì·¨ë¯¸ ì…ë ¥í•˜ê¸°) -->
    <div class="additional-box">
      <!-- í† ê¸€ ë²„íŠ¼ -->
      <button id="toggle-button" class="btn toggle-btn" onclick="toggleOtherHobby()">
        <span class="toggle-text">ë‹¤ë¥¸ ì·¨ë¯¸ë¥¼ ì…ë ¥í• ë˜ìš” âŒ¨</span> <!-- ì™¼ìª½ í…ìŠ¤íŠ¸ -->
        <span id="toggle-icon">â–¼</span>  <!-- ì˜¤ë¥¸ìª½ ì•„ì´ì½˜ -->
      </button>
    
      <!-- ìˆ¨ê²¨ì§„ ì½˜í…ì¸  -->
      <div id="additional-content" style="display: none;"> <!-- ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ -->
        <p class="description">
          ë‚˜ë§Œì˜ ì·¨ë¯¸ë¥¼ ì…ë ¥í•˜ê³  ì‹¶ì€ ì´ìš©ìë‹˜ì„ ìœ„í•´ ì¤€ë¹„í–ˆì–´ìš”! ì•„ë˜ ì…ë ¥ë€ì— ì´ìš©ìë‹˜ì˜ ì·¨ë¯¸ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.<br>
          <strong>TIP ğŸ’¡</strong> ë‹¨ì–´ëŠ” ì§§ê³  ê°„ê²°í• ìˆ˜ë¡ ë¶„ì„ ë ˆí¬íŠ¸ê°€ ë” ì •í™•í•´ì§„ë‹µë‹ˆë‹¤! (ì˜ˆ. 'ë‹¤ì´ì–´ë¦¬ì— ê¸°ë¡í•˜ê¸°'ë³´ë‹¤ 'ê¸°ë¡'ì´ ë” ì¢‹ì•„ìš”!)
        </p>
    
        <form method="post" action="{% url 'recommend-hobby' %}">
          {% csrf_token %}
          <input type="hidden" name="action_type" value="next">
    
          <div class="input-area">
            <input type="text" name="custom_hobby" placeholder="ì·¨ë¯¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”" class="input-field" required />
            <button type="submit" class="btn keyword-btn">í‚¤ì›Œë“œ í™•ì¸í•˜ê¸°</button>
          </div>
        </form>
      </div>
    </div>
  </div> 

</div> 
{% endblock %}

{% block extra_style %}

<style>
.content-box {
  padding: 30px 60px 30px 60px;
  margin-top: 30px;
  display: flex;              
  justify-content: center;    
  align-items: center;        
  text-align: center;          
}

/* ì¶”ê°€ ì½˜í…ì¸  ë°•ìŠ¤ */
.additional-box {
  width: 100%;
  background-color: #f5f5f5;
  padding: 30px 50px;
  border-radius: 20px;
  margin-top: 40px;
  box-sizing: border-box;
  text-align: center;
}

.additional-box .description {
  margin-top: 20px;  
}

/* ì„¤ëª… ë°•ìŠ¤ */
.description-box {
  border-radius: 20px;
  padding: 30px;
  width: 100%;
  text-align: left;
  padding: 10px 30px 0px 30px;
}

.section-title {
  font-size: 20px;
  font-weight: bold;
  margin-bottom: 15px;
}

.description {
  margin: 0; 
  color: #333;
  font-size: 15px;
  line-height: 1.6;
  margin-bottom: 30px;
}

/* ì°¨íŠ¸ ì˜ì—­ */
.hobby-rank-section {
  display: flex;
  flex-direction: column;
  width: 100%;
  max-width: 1000px;
  height: auto;
  min-height: unset;
  padding: 0;
  margin-top: -30px; /*ê·¸ë˜í”„ ìœ„ìª½ ë§ˆì§„! */
}

.chart-box {
  width: 100%;
  height: auto;
}

.chart-box iframe {
  width: 100%;
  height: 350px; 
  display: block;
}

/* ì¶”ì²œ ì·¨ë¯¸ ì„ íƒ */
.recommend-hobby-choice {
  width: 100%;
  max-width: 1000px; 
  padding: 30px;
  text-align: left; 
  padding: 30px;
  border-radius: 20px;
}

/* í…ìŠ¤íŠ¸ë§Œ ì™¼ìª½ ì •ë ¬ */
.recommend-text p {
  margin: 0 0 12px 0;
  padding-left: 0;
  text-align: left;
}

/* ë²„íŠ¼ì€ ì¤‘ì•™ ì •ë ¬ */
.button-group {
  display: flex;
  justify-content: center;
  flex-wrap: nowrap;
  margin-top: 40px;
}

.recommend-hobby-choice p {
  text-align: left; 
  width: 100%; 
  padding-left: 0; 
  margin: 0 0 10px 0;
}

.keyword-btn, .recommend-btn {
  display: inline-block;
  margin: 0 auto; 
}

.recommend-btn {
  padding: 12px 25px;
  font-size: 16px;
  width: 200px;
}

.recommend-btn.selected {
  background-color: #333;
  color: #fff;
}

.keyword-btn {
  margin-top: 0;
  font-weight: bold;
}

.submit-button {
  display: flex;
  justify-content: center;
  margin-top: 50px; 
}

/* í† ê¸€ ë²„íŠ¼ */
#toggle-button {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: transparent;  
  padding: 22px 20px;
  border: 1px solid #ddd;       
  color: #333;
  font-size: 18px;
  font-weight: 500;
  cursor: pointer;
  width: 100%;
  max-width: 1000px;
  transition: background-color 0.3s ease;
  border: none
}

/* í…ìŠ¤íŠ¸ì™€ ì•„ì´ì½˜ ì‚¬ì´ ê°„ê²©ì„ ì¡°ì • */
#toggle-button .toggle-text {
  font-size: 20px;
  font-weight: bold;
}

#toggle-button .toggle-icon {
  font-size: 20px;
  transition: transform 0.3s ease;
}

/* í™œì„±í™” ìƒíƒœ (ì„ íƒëœ í† ê¸€) */
#toggle-button.active {
  background-color: #d9eaff;
  border: 1px solid transparent;
  color: #333;
  font-weight: bold;
}

/* ë¹„í™œì„± ìƒíƒœì—ì„œ hover íš¨ê³¼ */
#toggle-button:not(.active):hover {
  background-color: #f5f5f5;
}

.toggle-btn {
  border: none;
  box-shadow: none;
  background-color: transparent;
}

.toggle-icon {
  font-size: 22px;
  transition: transform 0.3s ease;
  margin-left: 10px;
}

</style>
{% endblock %}

{% block extra_script %}
<script>
  function selectHobby(button, hobby) {
    const hiddenInput = document.getElementById('selected_hobby');

    // ë§Œì•½ ì´ë¯¸ ì„ íƒëœ ë²„íŠ¼ì´ í´ë¦­ë˜ë©´ ì„ íƒ í•´ì œ
    if (button.classList.contains('selected')) {
        button.classList.remove('selected'); // 'selected' í´ë˜ìŠ¤ ì œê±°
        hiddenInput.value = ''; // ì„ íƒëœ ì·¨ë¯¸ê°’ ì´ˆê¸°í™”
    } else {
        // ìƒˆë¡œ ì„ íƒëœ ë²„íŠ¼ì— 'selected' í´ë˜ìŠ¤ ì¶”ê°€
        const buttons = document.querySelectorAll('.recommend-btn');
        buttons.forEach(btn => btn.classList.remove('selected')); // ëª¨ë“  ë²„íŠ¼ì—ì„œ 'selected' í´ë˜ìŠ¤ ì œê±°
        button.classList.add('selected'); // í´ë¦­ëœ ë²„íŠ¼ì— 'selected' í´ë˜ìŠ¤ ì¶”ê°€
        hiddenInput.value = hobby; // ì·¨ë¯¸ê°’ ì„¤ì •
    }
}
  function toggleOtherHobby() {
      const content = document.getElementById('additional-content');
      const icon = document.getElementById('toggle-icon');

      if (content.style.display === 'block') {
        content.style.display = 'none';  // ìˆ¨ê¸°ê¸°
        icon.textContent = 'â–¼';          // ì•„ì´ì½˜ì„ 'â–¼'ë¡œ ë³€ê²½
      } else {
        content.style.display = 'block'; // ë³´ì—¬ì£¼ê¸°
        icon.textContent = 'â–²';          // ì•„ì´ì½˜ì„ 'â–²'ë¡œ ë³€ê²½
      }
  }
</script>
{% endblock %}
