{% extends "base.html" %}
{% load static %}

{% block title %}ì·¨ë¯¸ ê´€ë ¨ ìŠ¤ë§ˆíŠ¸í° ê¸°ëŠ¥ í‚¤ì›Œë“œ ì„ íƒí•˜ê¸°{% endblock %}

{% block content %}
<div class="container">

  <div class="center-container">

    <!-- í˜ì´ì§€ ì œëª© -->
    <h1 class="page-title">ìŠ¤ë§ˆíŠ¸í° ê¸°ëŠ¥ í‚¤ì›Œë“œ ì„ íƒí•˜ê¸°</h1>

    <!-- ë©”ì¸ ì½˜í…ì¸  ë°•ìŠ¤ -->
    <div class="content-box">

      <!-- ì„¤ëª… í…ìŠ¤íŠ¸ -->
      <h2 class="content-box-title">ì•Œì•„ë³´ê³  ì‹¶ì€ ê¸°ëŠ¥ì„ ì„ íƒí•´ì£¼ì„¸ìš” ğŸ“</h2>
      <div class="section-description">
        <p class="description">
          ì´ìš©ìë‹˜ì´ ê³ ë¥´ì‹  ì·¨ë¯¸ì™€ ê´€ë ¨ëœ ìŠ¤ë§ˆíŠ¸í° ê¸°ëŠ¥ í‚¤ì›Œë“œë¥¼ 5ê°€ì§€ ë½‘ì•„ë´¤ì–´ìš”.<br>
          ìì„¸íˆ ì•Œì•„ë³´ê³  ì‹¶ì€ í‚¤ì›Œë“œë¥¼ 3ê°œ ì´ìƒ ì„ íƒí•˜ê³ , â€˜ë¶„ì„ ë¦¬í¬íŠ¸ ë³´ëŸ¬ ê°€ê¸°â€™ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.
        </p>
      </div>

      <!-- ì„ íƒ ë°•ìŠ¤ ì˜ì—­ -->
      <div class="selection-boxes">

        <!-- ë‚˜ì˜ ì·¨ë¯¸ -->
        <div class="box">
          <h3>ë‚˜ì˜ ì·¨ë¯¸</h3>
          <div class="hobby-name">{{ selected_hobby }}</div>
        </div>

        <!-- í‚¤ì›Œë“œ ì„ íƒ -->
        <div class="box">
          <h3>ì·¨ë¯¸ ê´€ë ¨<br> ìŠ¤ë§ˆíŠ¸í° ê¸°ëŠ¥ í‚¤ì›Œë“œ</h3>

          <form method="POST" id="keywordForm" action="{% url 'start-analysis' %}" onsubmit="prepareSubmit()">
            {% csrf_token %}

            <!-- í‚¤ì›Œë“œ ë²„íŠ¼ë“¤ -->
            <div class="keywords">
              <div class="keywords-row row-1">
                {% for keyword in recommended_keywords|slice:":3" %}
                  <button type="button" class="keyword-btn" onclick="toggleSelect(this)">
                    {{ keyword }}
                  </button>
                {% endfor %}
              </div>
            
              <div class="keywords-row row-2">
                {% for keyword in recommended_keywords|slice:"3:" %}
                  <button type="button" class="keyword-btn" onclick="toggleSelect(this)">
                    {{ keyword }}
                  </button>
                {% endfor %}
              </div>
            </div>
            <!-- ì‹¤ì œ ì„ íƒëœ í‚¤ì›Œë“œ ê°’ -->
            <input type="hidden" name="selected_keywords" id="selected_keywords">


          </form>
        </div>

      </div> <!-- selection-boxes ë -->
      <div class="submit-button-wrapper">
        <button type="submit" class="submit-btn" form="keywordForm">ë¶„ì„ ë¦¬í¬íŠ¸ ë³´ëŸ¬ ê°€ê¸°</button>
      </div>

    </div> <!-- content-box ë -->

    <!-- ì¶”ê°€ ì½˜í…ì¸ ê°€ ìˆë‹¤ë©´ ì—¬ê¸°ì— ì¶”ê°€ -->
    <div class="additional-box"></div>

  </div> <!-- center-container ë -->

</div> <!-- container ë -->
{% endblock %}

{% block extra_style %}
<style>

/* ì„¤ëª… í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
.section-description {
  margin-bottom: 30px;
  align-self: flex-start;
}

.description {
  font-size: 16px;
  color: #333;
  line-height: 1.6;
  text-align: left;
}

.content-box-title {
  font-size: 20px;
  font-weight: bold;
  align-self: flex-start;
  margin-bottom: 10px;
  margin: 0;
}

/* ì„ íƒ ë°•ìŠ¤ë“¤ ë°°ì¹˜ */
.selection-boxes {
  display: flex;
  justify-content: space-between;
  gap: 20px;
  width: 100%;
}

/* ê°œë³„ ë°•ìŠ¤ */
.box {
  flex: 1;
  padding: 30px;
  border: 2px solid #aaa;
  border-radius: 20px;
  background-color: #f9f9f9;
  text-align: center;
}

.selection-boxes .box:first-child {
  flex-basis: 40%;
}

.selection-boxes .box:last-child {
  flex-basis: 60%;
  background-color: #FFF;
}

/* ì·¨ë¯¸ëª… */
.hobby-name {
  font-size: 24px;
  font-weight: bold;
  margin-top: 70px;
}


.keywords {
  display: flex;
  flex-direction: column;
  align-items: center; 
  gap: 20px;
  margin-top: 20px;
}

.keywords-row {
  display: flex;
  gap: 15px;
}

.row-1 {
  justify-content: center;
}

.row-2 {
  justify-content: center;
}

/* í‚¤ì›Œë“œ ë²„íŠ¼ */
.keyword-btn {
  padding: 15px 25px;
  border: 2px solid #333;
  border-radius: 25px;
  background-color: #fff;
  cursor: pointer;
  font-size: 16px;
  transition: 0.3s;
}

.keyword-btn.selected {
  background-color: #333;
  color: #fff;
}

/* ì œì¶œ ë²„íŠ¼ */
.submit-btn {
  margin-top: 30px;
  padding: 15px 40px;
  border-radius: 30px;
  background-color: #fff;
  border: 3px solid #333;
  font-size: 18px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s;
}

.submit-btn:hover {
  background-color: #333;
  color: #fff;
}
</style>
{% endblock %}

{% block extra_script %}
<script>
  const selected = new Set();

  function toggleSelect(button) {
    const keyword = button.textContent.trim();

    if (selected.has(keyword)) {
      selected.delete(keyword);
      button.classList.remove('selected');
    } else {
      selected.add(keyword);
      button.classList.add('selected');
    }
  }

  function prepareSubmit() {
  const hiddenInput = document.getElementById('selected_keywords');
  const keywordsArray = Array.from(selected);

  console.log("[DEBUG] ìµœì¢… ì„ íƒëœ í‚¤ì›Œë“œë“¤:", keywordsArray);

  hiddenInput.value = keywordsArray.join(',');
}

</script>
{% endblock %}
